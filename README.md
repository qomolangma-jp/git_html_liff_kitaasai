# 町内会デジタル配布希望者名簿登録システム (Town DX LIFF)

町内会の資料配布を「デジタル（LINE）」と「紙」のハイブリッド運用にするための、住民向け登録システムです。  
LINE上で住民が自身の希望（受取方法）を簡単に登録・変更できます。

## 📋 システム概要

本システムは、以下の3つの要素を組み合わせて動作します。

- **フロントエンド (GitHub Pages)**: 住民が操作する入力フォーム。
- **バックエンド (Google Apps Script)**: データの仲介とスプレッドシートへの書き込みを行うAPI。
- **データベース (Google スプレッドシート)**: 住民名簿および配布希望情報の管理。

## ✨ 機能

- LINE公式アカウントのメニューからワンタップで起動。
- LINEユーザーIDの自動取得（本人確認・重複登録の防止）。
- 氏名、フリガナ、班（1〜15）、配布希望（デジタル/紙）の登録・更新。
- 既存データがある場合は自動的に「更新」を行い、名簿の重複を防ぎます。

## 🚀 セットアップ手順

### 1. Google スプレッドシートと GAS の設定

1. スプレッドシートを新規作成し、シート名を「名簿」にします。
2. 1行目に以下のヘッダーを設定します：  
   `created_at`, `line_id`, `line_name`, `name`, `kana`, `group`, `is_digital`, `updated_at`
3. 「拡張機能」 > 「Apps Script」を開き、`Code.gs` を貼り付けます。
4. 「デプロイ」 > 「新しいデプロイ」を実行します。
   - **種類**: ウェブアプリ
   - **アクセスできるユーザー**: 全員
5. 発行された **ウェブアプリのURL** をメモします。

### 2. GitHub Pages の設定

1. 本リポジトリの `index.html` 内の以下の箇所を書き換えます。
   - `LIFF_ID`: LINE Developersで発行されたID。
   - `GAS_URL`: 手順1でメモしたGASのウェブアプリURL。
2. GitHubリポジトリの **Settings > Pages** から、GitHub Pagesを有効にします。
3. 公開された **GitHub PagesのURL** をメモします。

### 3. LINE Developers の設定

1. [LINE Developers Console](https://developers.line.biz/console/) で LIFF アプリを作成します。
2. **Endpoint URL** に、手順2でメモした GitHub PagesのURL を設定します。
3. **Scopes** 設定で `profile` にチェックを入れます。

## 📂 ファイル構成

- `index.html`: 住民向けフォーム画面（LIFFアプリ）。
- `Code.gs`: サーバーサイド処理プログラム。
- `README.md`: 本ドキュメント。

## 🛡️ セキュリティとプライバシー

- GASをAPIとして利用し、直接スプレッドシートを公開しない設計にしています。
- `line_id` をキーとすることで、なりすましによる名簿改ざんを防止しています。
- 個人情報を扱うため、GitHubリポジトリを **Private（非公開）** に設定することを推奨します。

## 🛠 今後の拡張予定

- 班長専用の確認画面（各班の統計表示）。
- 未登録者へのプッシュ通知機能。
